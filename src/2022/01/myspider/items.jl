{"href": "https://www.cnpython.com/qa/1478219", "title": "我刚刚创建了一个Python脚本。我正在尝试在我的windows计算机上运行它。它不起作用", "content": "<div class=\"show-content\"><p>我创建了一个名为“script.py”的python脚本：</p><pre><code>variable=raw_input(\"what is your name: \")\n\nprint \"welcome\",variable\n</code></pre><p>现在我试着在我的电脑上运行它，它会提示我“你叫什么名字”，然后我可以写下我的名字，然后它会向我打招呼。我该怎么做？我尝试使用命令pythonscript.py在cmd中编译脚本，但什么也没发生</p><p><strong>编辑：</strong><a href=\"https://i.stack.imgur.com/pE3eI.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/pE3eI.png\" alt=\"When I enter **python script.py** nothing happens\"></a></p><p>我还修改了代码，使其与python 3.8（我下载的版本）兼容</p></div>"}
{"href": "https://www.cnpython.com/qa/1478215", "title": "Python3刽子手游戏，使用.txt文档单词库", "content": "<div class=\"show-content\"><p>我试着用一个存储在.txt文件中的单词库制作一个刽子手，但我太困惑了，只是在兜圈子</p><p>谁能给我指出正确的方向吗？我的代码如下。干杯</p><pre><code>#Word list\nfrom random import choice\n\nword = with open(\"words.txt\") as f:\n    word_list = f.read().splitlines()\n\n#title\nprint(\"Welcome to Hangman! You have 7 lives to guess.\")\n\n#word generator\nhidden_word = random.sample(words,1)\n\nif(hidden_word[0]):\n    print(\"The length of the word is: \" , len(hidden_word[0]))\n\n#parameters\nguesses=0\nguessed = []\nword = []\n\n#Game\nfor x in range(len(hidden_word[0])):\n    word.append(' * ')\n\nwhile guesses &lt; 7:\n    guess = input(\"Please enter your next guess: \"\"\\n\")\n\n    if(guess in hidden_word[0]):\n        print(\"The letter is correct.\")\n        for index, letter in enumerate(hidden_word[0]):\n            if letter == guess:\n                word[index] = guess\n        guessed.append(guess)\n\n    else:\n            print(\"That letter is incorrect.\")\n            guesses=guesses+1\n            guessed.append(guess)\n\n    print(\"Please enter your next guess:\")\n    print(\"So far, you have answered - %s\"%''.join(word))\n    print()\n\n    if ''.join(word) == hidden_word[0]:\n        break\n\n#Game finish\nif guesses==7:\n    print(\"You lose. The word was:\" , hidden_word[0])\nelse:\n    print(\"Congratulations, you won!\")\n</code></pre></div>"}
{"href": "https://www.cnpython.com/qa/1478216", "title": "重新排列数组的多线程方法？", "content": "<div class=\"show-content\"><p>我有一个像'xooxox'一样的字符数组，我需要像'xxxooo'一样重新排列这个数组。我可以为此创建简单的python代码。但我正在寻找一种使用多线程的方法。有人能帮我做这件事吗</p></div>"}
{"href": "https://www.cnpython.com/qa/1478217", "title": "为什么python不将其识别为我的数据集，即使该文件显然存在于我的计算机上？", "content": "<div class=\"show-content\"><p>我是python的初学者，我正试图通过以下python教程来提高我的技能：\n<a href=\"https://towardsdatascience.com/exploratory-analysis-python-kaggle-data-b0afb6ec1788\" rel=\"nofollow noreferrer\">https://towardsdatascience.com/exploratory-analysis-python-kaggle-data-b0afb6ec1788</a></p><p>我键入的行是：</p><pre class=\"lang-py prettyprint-override\"><code>df = pd.read_csv('C:\\Stuff\\Python\\Medical Appointment Data\\792_3538_bundle_archive.zip\\KaggleV2-May-2016.csv')\n</code></pre><p>我认为这行代码是为了让python能够读取数据，以便我们以后可以构建一些图形。\n但当我输入它时，它会给我一个很长的错误：</p><p><a href=\"https://gyazo.com/28f7c49e70d3e968cdeb6fd653b4ea04\" rel=\"nofollow noreferrer\">https://gyazo.com/28f7c49e70d3e968cdeb6fd653b4ea04</a>（对不起，我不想占用太多空间，包括这里的所有内容）</p><p>我已经尝试了一些事情，包括移动我试图使用的文件，还有一些格式化的事情，比如更改我使用的引号和括号</p><p>我找到了这个页面，我想它引用了这个问题，但还没有找到任何有效的解决方案</p><p><a href=\"https://stackoverflow.com/questions/39267614/csv-file-does-not-exist-for-a-filename-with-embedded-quotes\">\"CSV file does not exist\" for a filename with embedded quotes</a></p><p>这是我到目前为止的完整代码：</p><pre><code>import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nfrom IPython import get_ipython\nipy = get_ipython()\nif ipy is not None:\n    ipy.run_line_magic('matplotlib', 'inline')\nimport plotly.plotly as pyimport plotly.offline as pyo\nimport plotly.graph_objs as go\npyo.offline.init_notebook_mode()\ndf = pd.read_csv('C:\\Stuff\\Python\\Medical Appointment Data\\792_3538_bundle_archive.zip\\KaggleV2-May-2016.csv')\n</code></pre><p>提前感谢您提供的一切帮助。\n如果你需要任何额外的信息，请告诉我。\n我也很抱歉，如果这是布局不好或不当。这是我的第一个问题，我已经尽力了。（如有必要，我也可以尝试修复）</p></div>"}
{"href": "https://www.cnpython.com/qa/1478218", "title": "使用Tensorflow数据集映射函数检索单个图像的多个句子", "content": "<div class=\"show-content\"><p>我正在尝试实现“展示、参与和讲述”论文中提出的具有视觉注意的神经图像字幕生成器。为了验证，我想计算Bleu分数。为此，我需要获取特定图像的所有标题。我想到的解决问题如下所示：</p><pre><code>data_path = './processed_data'\nsplit_type = 'val'\nencoded_captions = np.load(data_path + '/{}/captions_{}.npy'.format(split_type, split_type))\nimage_paths = json.load(open(data_path + '/{}/img_paths_{}.json'.format(split_type, split_type), 'r'))\n\nencoded_captions, image_paths = shuffle(encoded_captions, image_paths, random_state=0)\n\ndataset = tf.data.Dataset.from_tensor_slices((image_paths, encoded_captions))\n\ndataset = dataset.map(lambda img_path, cap: map_func(img_path, cap, image_paths, encoded_captions))\n\ndef map_func(img_path, caption, image_paths, encoded_captions):\n    matching_captions = [caption for i, caption in enumerate(encoded_captions) if image_paths[i] == img_path]\n    img = tf.io.read_file(img_path)\n    img = tf.image.decode_jpeg(img, channels=3)\n    img = tf.image.resize(img, (299, 299))\n    img = tf.keras.applications.inception_v3.preprocess_input(img)\n\n    return img, caption, matching_captions\n</code></pre><p>运行上述代码时，我遇到以下错误：</p><p>OperatorNotAllowedInGraphError:在图形执行中不允许将<code>tf.Tensor</code>用作Python <code>bool</code>。使用渴望执行或用@tf.function修饰此函数</p><p>我如何解决这个问题？或者，是否有一种更有效的方法来获取映射到特定图像的标题</p><p>多谢各位</p></div>"}
{"href": "https://www.cnpython.com/qa/1478212", "title": "在Python中处理<class'nltk.corpus.reader.wordlist.WordListCorpusReader'>", "content": "<div class=\"show-content\"><p>我正在使用Python中的“wordcloud”包，并尝试接受我自己的三种语言（英语、法语和德语）的停止词列表</p><p>这个“EN_FR_DE”停止字列表与我的电脑上的标准NLTK停止字列表一起存储在NLTK数据文件夹中，因为我也在其他上下文中使用它。我现在想导入这个自定义的stopword列表，将其转换为字符串并在“wordcloud”中使用。我使用“字符串”来转换列表。但是，当我检查其“类型”时，输出仍然是：</p><pre><code>&lt;class 'nltk.corpus.reader.wordlist.WordListCorpusReader'&gt;\n</code></pre><p>当然，“wordcloud”不接受此列表，并忽略所有停止词（参见下面链接的图表）</p><p><strong>我甚至不知道这是一个自己的类，我也找不到如何处理这种特殊类型的类的说明。将其转换为字符串的正确方法是什么？</strong></p><p>我构建wordcloud的完整脚本是：</p><pre><code># Generate word cloud from publication titles in English, French and German\n\nfrom wordcloud import WordCloud\nimport matplotlib.pyplot as plt \nimport string\nimport nltk\nfrom nltk.corpus import stopwords\n\ninfile=(\"C:\\\\Users\\\\mobarget\\\\Google Drive\\\\ACADEMIA\\\\Metadata_PhD\\\\BritishRiots_TopicModel\\\\British_riots_text.txt\")  \n\n# define stopwords and convert them to string\n\nstopwords_multiling=' '.join(stopwords.words('en_fr_de'))\nprint(stopwords_multiling[:50])\nprint(type(stopwords))\n\n# read and pre-process data\n\nwith open(infile, 'r', encoding='utf-8') as f: # open file\n    data1=f.read() # read content of file as string\n    data2=data1.translate(str.maketrans('', '', string.punctuation)).lower() # remove punctuation\n    data3=' '.join(data2.split()) # remove additional whitespace from text\n\n# define word cloud layout\n\nwordcloud = WordCloud(width = 800, height = 800, \n                background_color ='white', \n                stopwords = stopwords_multiling, \n                min_font_size = 10).generate(data3) \n\n# plot the WordCloud image   \n\nplt.figure(figsize = (8, 8), facecolor = None) \nplt.imshow(wordcloud, interpolation=\"bilinear\") \nplt.axis(\"off\") \nplt.tight_layout(pad = 0) \n\nplt.show() \n</code></pre><p>这是输出：</p><pre><code>i me my myself we our ours ourselves you you're yo\n&lt;class 'nltk.corpus.reader.wordlist.WordListCorpusReader'&gt;\n</code></pre><p><a href=\"https://i.stack.imgur.com/FJjOg.png\" rel=\"nofollow noreferrer\">Graph Image</a></p></div>"}
{"href": "https://www.cnpython.com/qa/1478210", "title": "Python3.8 list.append（'█') 但不适用于空格字符？", "content": "<div class=\"show-content\"><p>我是Python的初学者，正在努力编写我的第一个程序。我正在尝试创建一个游戏，游戏需要猜一个硬编码的句子</p><pre><code>mystery_sentence='All things excellent are as difficult as they are rare'\n\ndef printGuessedLetter():\n    print(\"This is the sentence to guess: \" + ''.join(userGuesslist))\n\n\nfor n in mystery_sentence:\n    userGuesslist.append('█')\nprintGuessedLetter()\n</code></pre><p>上面的代码返回：</p><p>这是要猜测的句子：█████████████████████████████████████████████████████ </p><p>下面是上面的一段代码：</p><pre><code>letter = input(\"&gt; Enter a letter:\\n&gt;&gt; \").lower()[0]\n\nif letter in userGuesses:\n    print(\"You've already submitted this letter\")\n\nelse:\n    attempts -= 1\n    userGuesses.append(letter)\n    if letter in mystery_sentence:\n        print(\"\\nNice guess\")\n        if attempts &gt; 0:\n            print(\"You have \", attempts, \"remaining attempt\")\n            for i in range(len(mystery_sentence)):\n                if letter == mystery_sentence[i]:\n                    letterIndex = i\n                    userGuesslist[letterIndex] = letter.upper()\n            printGuessedLetter()\n</code></pre><p>由于“猜测”一句包含空格，我认为玩家更容易看到以下内容：██ ██████ █████████ ███ ██ █████████ ██ ████ ███ ████ </p><p>然后，当玩家提交一封信时，它会如下所示：</p><p>下面是要猜测的句子：\n██ ██████ █████████ A.██ A.█ █████████ A.█ ████ A.██ █A.██ </p><p>等等</p><p>但是，我无法用完整块替换空格字符。我不确定list.append是正确的函数</p><p>有人有什么建议吗</p></div>"}
{"href": "https://www.cnpython.com/qa/1478213", "title": "具有两个条件的Pypark柱", "content": "<div class=\"show-content\"><p>我想筛选两个条件：<code>clean_reference.Output == \" \"</code><strong><em>和</em></strong><code>clean_reference.Primary == \"DEFAULT\"</code>。如果两个条件都适用，则<code>clean_reference.Output</code>否则<code>\"NI\"</code></p><p>下面的代码不接受my<code>clean_reference.Output</code>作为my when（）值</p><pre><code>final_reference = clean_reference.withColumn(\"Output\",f.when(clean_reference.Output == \" \")| (clean_reference.Primary == \"DEFAULT\"), clean_reference.Output).otherwise(\"NI\")\n</code></pre><pre><code>TypeError: when() missing 1 required positional argument: 'value'\n</code></pre></div>"}
{"href": "https://www.cnpython.com/qa/1478208", "title": "如何检查以下代码中的列表是否为空或数字是否为负数？", "content": "<div class=\"show-content\"><p>我必须首先返回可被<code>13</code>整除的数字列表。如果列表为空或数字为负数，则消息应为<code>invalid input</code></p><pre class=\"lang-py prettyprint-override\"><code>my_list_1 = [12, 65, 54, 39, 102, 339, 221, 50, 70, ]\n\ndef div_13(my_list):\n  my_list = numpy.array([])\n  result = list(filter(lambda x: (x % 13 == 0), my_list))\n  if (my_list.size != 0):\n    return(result)\n  else:\n    return('invalid input')\n\nprint(div_13('my_list_1'))\nprint(div_13(''))\n</code></pre></div>"}
{"href": "https://www.cnpython.com/qa/1478211", "title": "如何在discord.py中的某个时间间隔后向用户发送直接消息？", "content": "<div class=\"show-content\"><p>我想发出一个命令，在这个命令中，bot在一定的间隔后，比如说10秒，向消息的作者发送一个dm</p></div>"}
{"href": "https://www.cnpython.com/qa/1478214", "title": "Python，如何计算列表之间的差异", "content": "<div class=\"show-content\"><p>我有一张单子</p><p><code>a = [('A', 10, 7), ('B', 30, 5), ('C', 73, 12), ('D', 3, 12)]</code></p><p>需要计算列表中两个相邻点之间的差值</p><p>例如，（B-A），（C-B），（D-C）并获得以下输出：</p><p><code>output = [(20, -2), (43, 7), (-70, 0)</code></p><p>有什么快速的方法吗</p></div>"}
{"href": "https://www.cnpython.com/qa/1478209", "title": "插入具有自己唯一“\\u id”值的文档时发生BulkWriteError异常", "content": "<div class=\"show-content\"><p>我试图将一些测试数据插入到集合中，数据本身包含我已经创建的_id值</p><p>下面是我在使用insertmany（）pymongo命令写入集合时使用的一个小样本数据和代码</p><pre><code>def database_Insertions(data): #data is the list of dictionaries i am inserting\nmyClient = pymongo.MongoClient(\"mongodb://localhost:27017/\")\nmydb = myClient[\"Polling_Data\"]\nmycol = mydb[\"Test_Collection\"]\n\ntry:\n    mycol.insert_many(data)\nexcept BulkWriteError as bwe:\n    print(\"Writing Error Details \" ,bwe.details)\n</code></pre><p>这是我插入的数据样本。。\n<a href=\"https://pastebin.com/1Jvx0XFu\" rel=\"nofollow noreferrer\">data i am writing</a></p><p>当我试图运行这个时，我得到了一个“BulkWriteError”，当我用Try/Catch分解错误消息时，我得到了这个</p><pre><code>Writing Error Details  {'writeErrors': [{'index': 0, 'code': 11000, 'keyPattern': {'_id': 1}, 'keyValue': {'_id': 98800754}, 'errmsg': 'E11000 duplicate key error collection: Polling_Data.Test_Collection index: _id_ dup key: { _id: 98800754 }', 'op': {'_id': 98800754, 'Poll_Name': 'AL Daily News/Mason-Dixon', 'Date': '2020-02-04', 'Sample_Size': '625 RV', 'MoE': '4.0', 'Biden (D)': '58', 'Trump(R)': '38', 'Spread': 'Trump +20', 'State': 'Ohio'}}], 'writeConcernErrors': [], 'nInserted': 0, 'nUpserted': 0, 'nMatched': 0, 'nModified': 0, 'nRemoved': 0, 'upserted': []}\n</code></pre><p>除了嵌入的<strong>消息“E11000重复密钥错误收集”</strong>外，大多数消息都不有用。\n我几乎可以肯定，这与我使用自己的自定义id值有关，并且与该自定义id以及mongo作为默认值提供的自定义id存在某种冲突</p><p>非常感谢您的帮助</p></div>"}
{"href": "https://www.cnpython.com/qa/1478187", "title": "使用pandas统计从开始时间算起一小时内发生的用户订单，时间间隔不规则", "content": "<div class=\"show-content\"><p>假设我们有这个</p><pre><code>| eventdatetime       | orderid | userid |\n| 2019-12-27 03:06:50 | 1       |  100   |\n| 2019-12-27 04:12:50 | 2       |  20    |\n| 2019-12-27 05:06:58 | 3       |  140   |\n| 2019-12-29 03:00:10 | 4       |  104   |\n</code></pre><p>我尝试使用滚动groupby，例如<code>df.groupby('userid').rolling('1h').orderid.count()</code>，但它不起作用，因为它向后看了1个小时，并将其滚动到行中的当前日期时间。如果我使用滚动，它不期待在接下来的1小时内检查是否有订单</p><p>例如，如果查看orderid 2，则datetime为04:12:50，因此我想计算从该时间到05:12:50的1小时内的订单数量。换句话说，计算用户从04:12:50到05:12:50下的订单数量-在本例中是2，但滚动将得到1，因为它看起来是从03:12:50到04:12:50</p><p>熊猫身上有什么功能可以做到这一点，或者我对滚动理解有误吗</p><p><strong>编辑1</strong>\n起初我认为我可以只使用一些列，但不知怎么的，它不适用于原始列，所以我在混合中添加所有列</p><p>这里有datetime索引和3个id列</p><pre><code>                    | orderid           shopid      userid\nevent_time          \n2019-12-31 13:13:34 | 31468414075366    214432425   1134243\n2019-12-31 23:32:03 | 31505523761333    214432425   1134243\n2019-12-31 23:45:49 | 31506349293329    214432425   52594422\n2019-12-31 23:46:35 | 31506394434087    214432425   52594422\n</code></pre><p>使用Roy2012的解决方案\n但是添加了带有orderid的连接条件，因为我以后需要orderid，而不仅仅是时间</p><pre><code>hour_ends = pd.DataFrame({'hour_start': df.index, \n        'orderid': df.orderid.values\n    }, index=df.index + datetime.timedelta(hours=1)\n\nt = pd.merge(df, hour_ends, on='orderid', left_index=True, right_index=True, how='outer')\n</code></pre><p>给我</p><pre><code>                     orderid            shopid        userid        event_start\nevent_time              \n2019-12-31 13:13:34 | 31468414075366    214432425.0 | 1134243.0   | NaT\n2019-12-31 14:13:34 | 31468414075366    NaN         | NaN         |2019-12-31 13:13:34\n2019-12-31 23:32:03 | 31505523761333    214432425.0 | 1134243.0   | NaT\n2019-12-31 23:45:49 | 31506349293329    214432425.0 | 52594422.0  | NaT\n2019-12-31 23:46:35 | 31506394434087    214432425.0 | 52594422.0  | NaT\n2020-01-01 00:32:03 | 31505523761333    NaN         | NaN         | 2019-12-31 23:32:03\n2020-01-01 00:45:49 | 31506349293329    NaN         | NaN         | 2019-12-31 23:45:49\n2020-01-01 00:46:35 | 31506394434087    NaN         | NaN         | 2019-12-31 23:46:35\n</code></pre><p>然后将其添加到前滚</p><pre><code>t[\"rolling_count\"] = t.rolling(\"1h\", closed=\"both\").count()[\"orderid\"]\nt.reset_index()[['event_start', 'orderid', 'rolling_count']].dropna()\n</code></pre><p>给出了不符合的结果</p><pre><code>event_start         | orderid         | rolling_count\n2019-12-31 13:13:34 | 31468414075366  | 2.0\n2019-12-31 23:32:03 | 31505523761333  | 4.0\n2019-12-31 23:45:49 | 31506349293329  | 4.0\n2019-12-31 23:46:35 | 31506394434087  | 4.0\n</code></pre><p>我希望结果会是这样</p><pre><code>event_start         | orderid         | rolling_count\n2019-12-31 13:13:34 | 31468414075366  | 1.0\n2019-12-31 23:32:03 | 31505523761333  | 3.0\n2019-12-31 23:45:49 | 31506349293329  | 2.0\n2019-12-31 23:46:35 | 31506394434087  | 1.0\n</code></pre><p>由于orderid 31468414075366在13:13的1小时内只有一个订单，31505523761333在23:32到00:32的1小时内总共有3个订单，以此类推</p></div>"}
{"href": "https://www.cnpython.com/qa/1478188", "title": "带有动画的maplotlib.widgets", "content": "<div class=\"show-content\"><p>我正在尝试使用animation.FuncAnimation实时绘制串行数据，并希望能够为控制器设置目标值。所以我想在图形上有一个可编辑的文本框，它由标记为<code>target</code>的行实时反映出来，但我不知道如何将文本框与动画结合起来。当我把文本框代码放在循环函数之外时，它不做任何事情（但是绘图工作），但是当它在循环中时，文本框出现在图的中间，并且绘图不再工作。非常感谢您的帮助</p><pre><code>import matplotlib.pyplot as plt\nfrom matplotlib.widgets import TextBox\nimport matplotlib.animation as animation\nimport time\nimport random\n\n\ntarget = float(0.0)\ndef changeTarget(text):\n    try:\n        target = float(text)\n    except ValueError:\n        print(text + \" is not a number\")\n\ndef loop(i):\n    t.append(time.time() - tic)\n    data.append(random.random())\n    target_data.append(target)\n\n    ax.clear()\n    ax.plot(t, data, label='data')\n    ax.plot(t, target_data, label='target')\n    ax.set_xlabel('Time (s)')\n    ax.set_ylabel('Data')\n    ax.set_xlim([t[-1]-15, t[-1]+5])    \n    ax.set_ylim([min(min(data), min(target_data))-5, max(max(data), max(target_data))+5])\n    ax.legend()\n\n    # This part causes problems\n    text_box = TextBox(ax, 'Target:', initial=\"0\")\n    text_box.on_submit(changeTarget)\n    plt.draw()\n\nt = []\ndata = []\ntarget_data = []\n\nfig, ax = plt.subplots()\n# text_box = TextBox(ax, 'Target:', initial=\"0\")\n# text_box.on_submit(changeTarget)\n# plt.draw()\n\ntic = time.time()\nani = animation.FuncAnimation(fig, loop, interval = 100)\nplt.show()\n</code></pre><p>编辑：删除随机数据上的10倍乘数表明打印确实有效，但窗口似乎没有按应有的方式更新，小部件仍然位于轴的顶部，不可编辑</p></div>"}
{"href": "https://www.cnpython.com/qa/1478172", "title": "JSONDecodeError:预期值：TD Ameritrade API中的第2行第11列（字符11）", "content": "<div class=\"show-content\"><p>我对api和python非常陌生，知道一点代码，但我正在尝试从Td Ameritrade api中提取股票数据。\n我跟踪了几段youtube视频来获取这段代码以及它是如何为他们工作的，但是当我运行它时，我得到了一个错误：下面是完整的错误。如果有人知道如何避开这个问题，我们将不胜感激</p><pre><code>endpoint = r\"https://api.tdameritrade.com/v1/marketdata/{}/pricehistory\".format('GOOG')\n\npayload = {'apikey': apikey,\n           'periodType': 'day',\n           'frequencyType' : 'minute',\n           'frequency' : '1',\n           'period' : '2',\n           'needExtendedHourData' : 'true'}\n\ncontent = requests.get(url = endpoint, params = payload)\nprint()\n\ndata = content.json()\n\nprint(data)\n</code></pre><hr><pre><code>JSONDecodeError                           Traceback (most recent call last)\n&lt;ipython-input-102-6604869a0d57&gt; in &lt;module&gt;\n     10 content = requests.get(url = endpoint, params = payload)\n     11 \n---&gt; 12 data = content.json()\n     13 \n     14 print(data)\n\nc:\\users\\steve\\appdata\\local\\programs\\python\\python37\\lib\\site-packages\\requests\\models.py in json(self, **kwargs)\n    888                 try:\n    889                     return complexjson.loads(\n--&gt; 890                         self.content.decode(encoding), **kwargs\n    891                     )\n    892                 except UnicodeDecodeError:\n\nc:\\users\\steve\\appdata\\local\\programs\\python\\python37\\lib\\json\\__init__.py in loads(s, encoding, cls, object_hook, parse_float, parse_int, parse_constant, object_pairs_hook, **kw)\n    346             parse_int is None and parse_float is None and\n    347             parse_constant is None and object_pairs_hook is None and not kw):\n--&gt; 348         return _default_decoder.decode(s)\n    349     if cls is None:\n    350         cls = JSONDecoder\n\nc:\\users\\steve\\appdata\\local\\programs\\python\\python37\\lib\\json\\decoder.py in decode(self, s, _w)\n    335 \n    336         \"\"\"\n--&gt; 337         obj, end = self.raw_decode(s, idx=_w(s, 0).end())\n    338         end = _w(s, end).end()\n    339         if end != len(s):\n\nc:\\users\\steve\\appdata\\local\\programs\\python\\python37\\lib\\json\\decoder.py in raw_decode(self, s, idx)\n    353             obj, end = self.scan_once(s, idx)\n    354         except StopIteration as err:\n--&gt; 355             raise JSONDecodeError(\"Expecting value\", s, err.value) from None\n    356         return obj, end\n\nJSONDecodeError: Expecting value: line 2 column 11 (char 11)\n</code></pre></div>"}
{"href": "https://www.cnpython.com/qa/1478190", "title": "为什么在模型可行的情况下，我不能从Gurobipy那里得到影子价格？", "content": "<div class=\"show-content\"><p>我试图解决点对点市场优化问题。由于不同参与者之间每笔交易的价格可能不同，我想画出每笔交易的价格。问题应该是一个连续的模型，因为贸易额可以是任何水平</p><p>该模型已经运行良好，没有问题，我可以使用类似<code>model.variables.trade[t,k,y].x</code>的方法获得每笔交易的交易金额</p><p>但问题是，当我试图从相关约束中获得影子价格时，它显示：<code>GurobiError: Unable to retrieve attribute 'Pi'</code></p><p>我不知道这个错误是怎么来的，因为这个模型已经是可行的，我要做的就是得到一个已经存在的属性</p><p>我的代码的相关部分如下所示：</p><pre><code>def _build_constraints(self):\n        m = self.model\n        P_nm3 = self.variables.P_nm3\n        agents = self.data.agents\n\n        timewindow = self.data.timewindow           \n        windowinterval = self.data.windowinterval      \n        budget = self.data.budget\n        P_n = self.variables.P_n\n\n        self.constraints.pnmmatch = {}    \n        ......\n\n        for t in self.data.interval:\n            for i in range(len(P_nm3[t])):\n                for j in range(len(P_nm3[t][0])):\n                    self.constraints.pnmmatch[t,i,j] = m.addConstr(\n                            P_nm3[t][i][j],\n                            gb.GRB.EQUAL,\n                            -P_nm3[t][j][i]\n                            )\n        .......\npoolmarket = marketclear()\npoolmarket.optimize()\n\nprint(poolmarket.constraints.pnmmatch[0,1,6])\nprint(type(poolmarket.constraints.pnmmatch))\n\nprint(poolmarket.constraints.pnmmatch[0,1,6].pi)\nshadow_price = poolmarket.model.getAttr(gb.GRB.Attr.Pi)\n</code></pre><p>结果是：</p><pre><code>&lt;gurobi.Constr R1001&gt;\n&lt;class 'dict'&gt;\nAttributeError: Unable to retrieve attribute 'pi'\n</code></pre><p><code>poolmarket.constraints.pnmmatch[0,1,6].pi</code>或<code>poolmarket.model.getAttr(gb.GRB.Attr.Pi)</code>都不起作用。\n如果我对关于pi的最后两行进行评论，那么这些模型运行得非常好</p><p>但在更简单的类似模型中，约束条件为：</p><pre><code>        for t in self.data.interval:\n            for i in range(len(P_nm3[t])):\n                for j in range(len(P_nm3[t][0])):\n                    self.constraints.pnmmatch[t] = m.addConstr(\n                            P_nm3[t][i][j],\n                            gb.GRB.EQUAL,\n                            -P_nm3[t][j][i]\n                            )\n</code></pre><p>然后我可以用<code>poolmarket.constraints.pnmmatch[0].pi</code>命令绘制pi值</p><p>我怎样才能解决这个问题</p><p>提前谢谢</p></div>"}
{"href": "https://www.cnpython.com/qa/1478191", "title": "spaCy:找不到模型“it”", "content": "<div class=\"show-content\"><p>你能告诉我我在下面的代码中遗漏了什么吗？我正在尝试使用一些定义的函数（在文章的底部），这些函数可以帮助我删除stopwords、形成bigram和进行一些柠檬化。语言是意大利语。我正在利用空间这样做</p><pre><code>!python -m spacy download it_core_news_sm\n\nimport spacy\nnlp = spacy.load(\"it_core_news_sm\")\n\ndata_words_nostops = remove_stopwords(tok_text_list)\n\n# Form Bigrams\ndata_words_bigrams = make_bigrams(data_words_nostops)\n\nnlp = spacy.load('it', disable=['parser', 'ner'])\n\n# Do lemmatization keeping only noun, adj, vb, adv\ndata_lemmatized = lemmatization(data_words_bigrams, allowed_postags=['NOUN', 'ADJ', 'VERB', 'ADV'])\n\nprint(data_lemmatized[:1])\n</code></pre><p>在哪里</p><pre><code>tok_text_list= [['papa',\n  ',',\n  \"l'aspirante\",\n  'pilota',\n  'anni',\n  'morto',\n  'fiume',\n  'tevere',\n  'seguito',\n  \"all'incidente\",\n  \"l'aereo\",\n  '.',\n  'spiaggia',\n  'campo',\n  'mare',\n  'é',\n  'vietata',\n  'disabili',\n  '.'], [...]]\n</code></pre><p>我得到的错误是：</p><pre><code>OSError                                   Traceback (most recent call last)\n&lt;ipython-input-216-775b3f412d6f&gt; in &lt;module&gt;\n\n---&gt; 14 nlp = spacy.load('it', disable=['parser', 'ner'])\n     15 \n     16 # Do lemmatization keeping only noun, adj, vb, adv\n\n    OSError: [E050] Can't find model 'it'. It doesn't seem to be a shortcut link, a Python package or a valid path to a data directory.\n</code></pre><p>也许我忘了在代码中包含一些东西或下载其他文件。我还尝试按照这里的建议重新运行所有内容：<a href=\"https://stackoverflow.com/questions/58362949/loading-the-spacy-german-language-model-into-a-jupyter-notebook\">Loading the spacy german language model into a jupyter notebook</a>。\n我在用朱庇特笔记本</p><p>谢谢</p></div>"}
{"href": "https://www.cnpython.com/qa/1478171", "title": "给定一个项目，如何获得未对此项目进行评级的用户的推荐？", "content": "<div class=\"show-content\"><p>我的用例：</p><p>给定一个项目，我想得到未对该项目进行评分的用户的建议</p><p>我发现这个惊人的Python库可以回答我的用例：</p><p>python recsys<a href=\"https://github.com/ocelma/python-recsys\" rel=\"nofollow noreferrer\">https://github.com/ocelma/python-recsys</a></p><p>示例如下所示</p><p>哪些用户应该看玩具总动员？（例如，哪些没有给《玩具总动员》评分的用户会给它高评分？）</p><pre><code>svd.recommend(ITEMID)\n\n# Returns: &lt;USERID, Predicted Rating&gt;\n[(283,  5.716264440514446),\n (3604, 5.6471765418323141),\n (5056, 5.6218800339214496),\n (446,  5.5707524860615738),\n (3902, 5.5494529168484652),\n (4634, 5.51643364021289),\n (3324, 5.5138903299082802),\n (4801, 5.4947999354188548),\n (1131, 5.4941438045650068),\n (2339, 5.4916048051511659)]\n</code></pre><p>此实现使用SVD预测用户给出的分级，并返回最初未分级的最高分级用户电影的用户id</p><p>不幸的是，这个库是使用Python2.7编写的，它与我的项目不兼容</p><p>我还发现了Scikit惊喜库，它有一个类似的例子</p><p><a href=\"https://surprise.readthedocs.io/en/stable/FAQ.html#how-to-get-the-k-nearest-neighbors-of-a-user-or-item\" rel=\"nofollow noreferrer\">https://surprise.readthedocs.io/en/stable/FAQ.html#how-to-get-the-k-nearest-neighbors-of-a-user-or-item</a></p><pre><code>import io  # needed because of weird encoding of u.item file\n\nfrom surprise import KNNBaseline\nfrom surprise import Dataset\nfrom surprise import get_dataset_dir\n\n\ndef read_item_names():\n    \"\"\"Read the u.item file from MovieLens 100-k dataset and return two\n    mappings to convert raw ids into movie names and movie names into raw ids.\n    \"\"\"\n\n    file_name = get_dataset_dir() + '/ml-100k/ml-100k/u.item'\n    rid_to_name = {}\n    name_to_rid = {}\n    with io.open(file_name, 'r', encoding='ISO-8859-1') as f:\n        for line in f:\n            line = line.split('|')\n            rid_to_name[line[0]] = line[1]\n            name_to_rid[line[1]] = line[0]\n\n    return rid_to_name, name_to_rid\n\n\n# First, train the algortihm to compute the similarities between items\ndata = Dataset.load_builtin('ml-100k')\ntrainset = data.build_full_trainset()\nsim_options = {'name': 'pearson_baseline', 'user_based': False}\nalgo = KNNBaseline(sim_options=sim_options)\nalgo.fit(trainset)\n\n# Read the mappings raw id &lt;-&gt; movie name\nrid_to_name, name_to_rid = read_item_names()\n\n# Retrieve inner id of the movie Toy Story\ntoy_story_raw_id = name_to_rid['Toy Story (1995)']\ntoy_story_inner_id = algo.trainset.to_inner_iid(toy_story_raw_id)\n\n# Retrieve inner ids of the nearest neighbors of Toy Story.\ntoy_story_neighbors = algo.get_neighbors(toy_story_inner_id, k=10)\n\n# Convert inner ids of the neighbors into names.\ntoy_story_neighbors = (algo.trainset.to_raw_iid(inner_id)\n                       for inner_id in toy_story_neighbors)\ntoy_story_neighbors = (rid_to_name[rid]\n                       for rid in toy_story_neighbors)\n\nprint()\nprint('The 10 nearest neighbors of Toy Story are:')\nfor movie in toy_story_neighbors:\n    print(movie)\n</code></pre><p>印刷品</p><pre><code>The 10 nearest neighbors of Toy Story are:\nBeauty and the Beast (1991)\nRaiders of the Lost Ark (1981)\nThat Thing You Do! (1996)\nLion King, The (1994)\nCraft, The (1996)\nLiar Liar (1997)\nAladdin (1992)\nCool Hand Luke (1967)\nWinnie the Pooh and the Blustery Day (1968)\nIndiana Jones and the Last Crusade (1989)\n</code></pre><p>如何更改代码以获得类似上面python recsys示例的结果？\n提前谢谢</p></div>"}
{"href": "https://www.cnpython.com/qa/1478189", "title": "如何保存类的Keras模型实例", "content": "<div class=\"show-content\"><p>我使用谷歌的Seq2Seq项目，该项目使用编码器/解码器，有2个编码器和解码器类：</p><pre><code>#ENCODER\nclass EncoderNetwork(tf.keras.Model):\n    def __getstate__(self):\n        d = self.__dict__.copy()\n        d.pop('_parents', None)\n        return d\n\n    def __init__(self,input_vocab_size,embedding_dims, rnn_units ):\n        super().__init__()\n        self.encoder_embedding = tf.keras.layers.Embedding(input_dim=input_vocab_size,\n                                                           output_dim=embedding_dims)\n        self.encoder_rnnlayer = tf.keras.layers.LSTM(rnn_units,return_sequences=True, \n                                                     return_state=True )\n        encoder_embedding = self.encoder_embedding\n        encoder_rnnlayer = self.encoder_rnnlayer\n\n#DECODER\nclass DecoderNetwork(tf.keras.Model):\n    def __getstate__(self):\n        d = self.__dict__.copy()\n        d.pop('_parents', None)\n        return d \n    def __init__(self,output_vocab_size, embedding_dims, rnn_units):\n        super().__init__()\n        self.decoder_embedding = tf.keras.layers.Embedding(input_dim=output_vocab_size,\n                                                           output_dim=embedding_dims) \n        self.dense_layer = tf.keras.layers.Dense(output_vocab_size)\n        self.decoder_rnncell = tf.keras.layers.LSTMCell(rnn_units)\n        # Sampler\n        self.sampler = tfa.seq2seq.sampler.TrainingSampler()\n        # Create attention mechanism with memory = None\n        self.attention_mechanism = self.build_attention_mechanism(dense_units,None,BATCH_SIZE*[Tx])\n        self.rnn_cell =  self.build_rnn_cell(BATCH_SIZE)\n        self.decoder = tfa.seq2seq.BasicDecoder(self.rnn_cell, sampler= self.sampler,\n                                                output_layer=self.dense_layer)\n\n    def build_attention_mechanism(self, units,memory, memory_sequence_length):\n        return tfa.seq2seq.LuongAttention(units, memory = memory, \n                                          memory_sequence_length=memory_sequence_length)\n        #return tfa.seq2seq.BahdanauAttention(units, memory = memory, memory_sequence_length=memory_sequence_length)\n\n    # wrap decodernn cell  \n    def build_rnn_cell(self, batch_size ):\n        rnn_cell = tfa.seq2seq.AttentionWrapper(self.decoder_rnncell, self.attention_mechanism,\n                                                attention_layer_size=dense_units)\n        return rnn_cell\n\n    def build_decoder_initial_state(self, batch_size, encoder_state,Dtype):\n        decoder_initial_state = self.rnn_cell.get_initial_state(batch_size = batch_size, \n                                                                dtype = Dtype)\n        decoder_initial_state = decoder_initial_state.clone(cell_state=encoder_state) \n        return decoder_initial_state\n\n</code></pre><p>我用我的参数创建一个EncoderNetwork和DecoderNetwork的实例，并使用已经定义的loss_函数和train_步骤来训练我的模型</p><pre><code>def loss_function(y_pred, y):\n\n    #shape of y [batch_size, ty]\n    #shape of y_pred [batch_size, Ty, output_vocab_size] \n    sparsecategoricalcrossentropy = tf.keras.losses.SparseCategoricalCrossentropy(from_logits=True,\n                                                                                  reduction='none')\n    loss = sparsecategoricalcrossentropy(y_true=y, y_pred=y_pred)\n    mask = tf.logical_not(tf.math.equal(y,0))   #output 0 for y=0 else output 1\n    mask = tf.cast(mask, dtype=loss.dtype)\n    loss = mask* loss\n    loss = tf.reduce_mean(loss)\n    return loss\n\n\ndef train_step(input_batch, output_batch,encoder_initial_cell_state):\n    #initialize loss = 0\n    loss = 0\n    with tf.GradientTape() as tape:\n        encoder_emb_inp = encoderNetwork.encoder_embedding(input_batch)\n        a, a_tx, c_tx = encoderNetwork.encoder_rnnlayer(encoder_emb_inp, \n                                                        initial_state =encoder_initial_cell_state)\n\n        #[last step activations,last memory_state] of encoder passed as input to decoder Network\n\n\n        # Prepare correct Decoder input &amp; output sequence data\n        decoder_input = output_batch[:,:-1] # ignore &lt;end&gt;\n        #compare logits with timestepped +1 version of decoder_input\n        decoder_output = output_batch[:,1:] #ignore &lt;start&gt;\n\n\n        # Decoder Embeddings\n        decoder_emb_inp = decoderNetwork.decoder_embedding(decoder_input)\n\n        #Setting up decoder memory from encoder output and Zero State for AttentionWrapperState\n        decoderNetwork.attention_mechanism.setup_memory(a)\n        decoder_initial_state = decoderNetwork.build_decoder_initial_state(BATCH_SIZE,\n                                                                           encoder_state=[a_tx, c_tx],\n                                                                           Dtype=tf.float32)\n\n        #BasicDecoderOutput        \n        outputs, _, _ = decoderNetwork.decoder(decoder_emb_inp,initial_state=decoder_initial_state,\n                                               sequence_length=BATCH_SIZE*[Ty-1])\n\n        logits = outputs.rnn_output\n        #Calculate loss\n\n        loss = loss_function(logits, decoder_output)\n\n    #Returns the list of all layer variables / weights.\n    variables = encoderNetwork.trainable_variables + decoderNetwork.trainable_variables  \n    # differentiate loss wrt variables\n    gradients = tape.gradient(loss, variables)\n\n    #grads_and_vars – List of(gradient, variable) pairs.\n    grads_and_vars = zip(gradients,variables)\n    optimizer.apply_gradients(grads_and_vars)\n    return loss\n</code></pre><p>培训不使用fit（）方法，但如下所示：</p><pre><code>epochs = 20\nfor i in range(1, epochs+1):\n\n  encoder_initial_cell_state = initialize_initial_state()\n  total_loss = 0.0\n\n  for ( batch , (input_batch, output_batch)) in enumerate(dataset.take(steps_per_epoch)):\n      batch_loss = train_step(input_batch, output_batch, encoder_initial_cell_state)\n      total_loss += batch_loss\n      if (batch+1)%5 == 0:\n          print(\"total loss: {} epoch {} batch {} \".format(batch_loss.numpy(), i, batch+1))\n</code></pre><p>结果很好，预测功能运行良好（自定义预测功能），但如何保存模型？我试过pickel和keras.save（），但都不管用，你知道吗</p></div>"}
{"href": "https://www.cnpython.com/qa/1478170", "title": "设置所有标签的列宽和字体大小？", "content": "<div class=\"show-content\"><p>刚刚开始一些<code>GUI</code>的工作。我对<code>tkinter</code>绝对是个新手</p><p>我可以使用<code>.config</code>为单个标签设置<code>label</code>宽度和字体大小</p><p>我想将此设置为特定列的默认设置</p><p>我试过：</p><p><code>Label.config(width=70, font=('Courier',15))</code></p><p>但不断出现错误：</p><blockquote><p>Traceback (most recent call last):\n    File \"/usr/local/lib/python3.6/dist-packages/IPython/core/interactiveshell.py\", line 3331, in run_code\n      exec(code_obj, self.user_global_ns, self.user_ns)\n    File \"\", line 8, in \n      Label.config(width=70, font=('Courier',15))\n  TypeError: configure() missing 1 required positional argument: 'self'</p></blockquote><p>正确的方法是什么</p><p>完整代码：</p><pre><code>from tkinter import *\nfrom tkinter import ttk\n\nreasons_window = Tk()\nttk.Style.configure('TLabel',width=70,font=('Courier',15))\nreasons_window.geometry(\"500x200\")\n\n# Create rows for the reasons to be entered.\nlabel1 = ttk.Label(reasons_window, text=\"Qty\")\nlabel1.grid(row=0,column=0)\n\n# for field in fields\ne1 = Entry(reasons_window)\ne1.grid(row=0,column=1)\ndef eval_click():\n    if int(e1.get()) == 100:\n        print('GO AHEAD')\n\neval_button = Button(reasons_window, text=\"Evaluate\", command=eval_click)\neval_button.grid(row=3, column=0)\n\n\nreasons_window.mainloop()\n</code></pre></div>"}
{"href": "https://www.cnpython.com/qa/1478173", "title": "如何在“如果”条件下检查错误以做出决策？", "content": "<div class=\"show-content\"><p>假设我有一本字典：</p><pre><code>myList ={1:'One', 2:'two', 3:'three'}\n</code></pre><p>我的代码是：</p><pre><code>if myList[4]:\n   last = myList[4]\nelse:\n   last = myList[3]\n</code></pre><p>这将返回一个<code>KeyError</code></p><p>我知道<code>myList.get(4,'Something')</code>。但我在找别的东西</p><p>是否有类似于：</p><pre><code>if 'KeyError' myList[4]:\n   last = myList[3]\nelse:\n   last = myList[4]\n</code></pre><p>这里解释了这样的方法<a href=\"https://realpython.com/python-keyerror/\" rel=\"nofollow noreferrer\">https://realpython.com/python-keyerror/</a>。我试过了。但当<code>myList[4]</code>不存在时，它仍然会引发<code>KeyError</code>。有人能帮我找到我在这里遗漏了什么吗</p><pre><code>myList={1:'one', 2:'two', 3:'three'}\n\nif 'keyError' in myList[4]:\n    last = myList['3']\nelse:\n    last = myList['4']\n\nTraceback (most recent call last):\nFile \"&lt;stdin&gt;\", line 1, in &lt;module&gt;\nKeyError: 4\n</code></pre><p><code>try...except</code>方法不适合我。这使得我的代码冗长而缓慢</p></div>"}
{"href": "https://www.cnpython.com/qa/1478174", "title": "如何使用SQLAlchemy保持烧瓶中的平均功能？", "content": "<div class=\"show-content\"><p>假设我创建了一个表ratings、books和users，如下所示：</p><pre><code>    CREATE TABLE books(\n  id SERIAL PRIMARY KEY,\n  ISBN VARCHAR NOT NULL,\n  title VARCHAR NOT NULL,\n  author VARCHAR NOT NULL,\n  publicationYear INTEGER NOT NULL\n);\n\n    CREATE TABLE ratings(\n  id SERIAL PRIMARY KEY,\n  user_id INTEGER REFERENCES users(id),\n  book_id INTEGER REFERENCES books(id),\n  rating INTEGER CHECK (rating &lt;= 5)\n);\n\nCREATE TABLE users(\n  id SERIAL PRIMARY KEY,\n  username VARCHAR UNIQUE,\n  password VARCHAR NOT NULL,\n);\n</code></pre><p>我试着建立一个网站，在那里我可以给一本书打分，而这本书在每次有用户给这本书打分时，应该保持它的平均评分。\n我的尝试：在application.py中的某个路由下：\n.... </p><pre><code>rating = db.execute(\"SELECT AVG(rating) FROM ratings WHERE book_id = :id\", {\"id\": book_id}).fetchone()\n    if rating is None:\n        rating = 0\n....\nreturn render_template(\"details.html\", rating = rating, book = book)\n</code></pre><p>Inside details.html：</p><pre><code>(some html code)\nRating: {{ rating }} out of 5\n(some other html code)\n</code></pre><p>一切正常（没有任何错误），但有两个问题我无法解决：</p><p>1）如果没有评分，我希望网站显示0（评分），但它显示“（无，）”</p><p>2）如果有评级，则不显示（例如）4.5作为评级（我希望答案四舍五入到小数点后1位），而是显示“（十进制（'4.5000000000000000'），”</p><p>如何解决这些问题，以及为什么它检索的不是float（我假设是因为评级有整数以外的其他类型）</p><p>备注：我不能使用任何东西，比如创建类/对象或特殊的SQLAlchemy属性，只能使用上面提到的SQL查询</p></div>"}
{"href": "https://www.cnpython.com/qa/1478175", "title": "对Python的skimage的img_as_float函数输出感到困惑吗", "content": "<div class=\"show-content\"><p>我知道Python的skimage的img_as_float函数返回0到1之间的值。然而，当我运行这段代码时，我无法解释为什么我得到的输出对我来说毫无意义</p><pre><code>&gt;&gt;&gt; img_as_float([1,2])\narray([1.62630326e-19, 2.71050543e-19])\n</code></pre><p>1和2是如何转化成这些数字的？我认为img_as_float输出float64中0到1之间的所有内容，因此我认为将1/256和2/256作为输出是有意义的</p><p>任何帮助都将不胜感激。由于这个令人困惑的问题，目前在工作中非常困难</p></div>"}
{"href": "https://www.cnpython.com/qa/1478179", "title": "在计算渐变时，使用“添加权重”将Keras自定义层中的权重串联失败", "content": "<div class=\"show-content\"><p>在编写自定义层时，我需要将多个权重矩阵连接在一起。如果我在<code>build</code>函数中执行此操作，我会得到错误<code>ValueError: No gradients provided for any variable:...</code>，但是，如果我在<code>build</code>中列出wight并在<code>call</code>中连接它们，它会工作。以下是产生错误的最小代码：</p><pre class=\"lang-py prettyprint-override\"><code>class MultiInputLinear(Layer):\n    def __init__(self, output_dim=32, n_inputs=2):\n        super(Linear, self).__init__()\n        self.output_dim = output_dim\n        self.n_inputs = n_inputs\n\n\n    def build(self, input_shapes):\n        self.input_dim = input_shapes[0][1]\n\n        self.W = tf.concat(\n            [\n                self.add_weight(\n                    name=f'W_{i}',\n                    shape=(self.input_dim, self.output_dim),\n                    initializer='random_normal',\n                    trainable=True\n                ) for i in range(self.n_inputs)\n            ], axis=0\n        )\n\n    def call(self, inputs):  \n        supports = tf.concat(inputs, axis=-1)        \n        return tf.matmul(supports, self.W)\n\nN = 100\nA = [np.random.normal(size=(N, N)) for _ in range(2)]\ny = np.random.binomial(1, .1, size=(N, 32))\n\nA_in = [Input(batch_size=N, shape=(N, )) for _ in range(2)]\nY = MultiInputLinear(y.shape[1], 2)(A_in)\n\nmodel = Model(inputs=A_in, outputs=Y)\nmodel.compile(loss='categorical_crossentropy', optimizer=Adam())\n\nmodel.fit(A, y, batch_size=N)\n\n</code></pre><p>但是，如果在<code>build</code>中，我保留如下列表：</p><pre class=\"lang-py prettyprint-override\"><code>self.W_list = [\n                self.add_weight(\n                    name=f'W_{i}',\n                    shape=(self.input_dim, self.output_dim),\n                    initializer='random_normal',\n                    trainable=True\n                ) for i in range(self.n_inputs)\n            ]\n</code></pre><p>然后在<code>call</code>内部，我将它们连接起来，如下所示，不会有问题：</p><pre class=\"lang-py prettyprint-override\"><code>    def call(self, inputs):  \n        supports = tf.concat(inputs, axis=-1)\n        W = tf.concat(self.W_list, axis=0)\n\n        return tf.matmul(supports, W)\n</code></pre><p>我想知道这是什么原因</p></div>"}
{"href": "https://www.cnpython.com/qa/1478176", "title": "矩阵形式的简单符号LP问题", "content": "<div class=\"show-content\"><p><strong>我解决了一个线性规划问题，这是我的符号形式代码。</strong></p><pre><code>import cvxpy as cp\nimport numpy as np\n\nx11 = cp.Variable(nonneg=True)\nx12 = cp.Variable(nonneg=True)\nx21 = cp.Variable(nonneg=True)\nx22 = cp.Variable(nonneg=True)\nx31 = cp.Variable(nonneg=True)\nx32 = cp.Variable(nonneg=True)\n\nconstraints = [x11 + x12 == 1000,\n              x21 + x22 == 1500,\n              x31 + x32 == 1200,\n              x11 + x21 + x31 == 2300,\n              x12 + x22 + x32 == 1400]\n\nobj = cp.Minimize((80*x11 + 215*x12 + 100*x21 + 108*x22 + 102*x31 + 68*x32))\n\nprob = cp.Problem(obj, constraints)\nprob.solve()\nprint('status: ', prob.status)\nprint('optimal value: ', prob.value)\nprint('optimal variables: ', x11.value, x12.value, x21.value, x22.value, x31.value, x32.value)\n</code></pre><p>状态：最佳</p><p>最佳值：313200.00003146095</p><p>最佳变量：999.9999999627637 3.7235625579412695e-08 1299.99999940076 200.00000059923934 6.364774533690845e-07 1199.99999363524</p><p><strong>但我想将此代码更改为矩阵形式。这是我的另一个矩阵形式代码</strong></p><pre><code>x = cp.Variable((3, 2), nonneg=True)\n\nconstraints = [cp.sum(x[0,:]) == 1000,\n              cp.sum(x[1,:]) == 1500,\n              cp.sum(x[2,:]) == 1200,\n              cp.sum(x[:, 0]) == 2300,\n              cp.sum(x[:, 1]) == 1400]\n\ncoe = [[80, 215], [100, 108], [102, 68]]\n\nt\nobj = cp.Minimize(cp.sum(coe @ x))\n\nprob = cp.Problem(obj, constraints)\nprob.solve()\nprint('status: ', prob.status)\nprint('optimal value: ', prob.value)\nfor i in range(3):\n    for j in range(2):\n        print('optimal variables:x('+str(i)+','+str(j)+')', x[i,j].value)\n\n</code></pre><p>状态：最佳</p><p>最佳值：810999.999986519</p><p>最优变量：x（0,0）649.9892627159586</p><p>最优变量：x（0,1）350.01073728291954</p><p>最优变量：x（1,0）900.0113075911175</p><p>最优变量：x（1,1）599.9886924056102</p><p>最优变量：x（2,0）749.9994296884455</p><p>最优变量：x（2,1）450.00057030957413</p><p><strong>我认为结果应该是相同的，矩阵形式代码是错误的。你能找出我的错误吗？</strong></p></div>"}
{"href": "https://www.cnpython.com/qa/1478177", "title": "用于返回n维数组索引的Python函数", "content": "<div class=\"show-content\"><p>所以我有一个函数，它在n维数组中查找类的位置，还有一个函数，它获取该值并将其转换（或至少尝试转换）为一个索引，该索引可用于访问和返回该类</p><pre><code>def get_class(condition1, condition2):\n    key = \"\"\n    if(condition1):\n        key += \"1 \"\n    else:\n        key += \"0 \"\n    if(condition2):\n        key += \"1 \"\n    else:\n        key += \"0 \"\n    key = get_key(key)\n\n    return classes[key]\n</code></pre><p>它的工作原理是在前进的过程中加上一个字符串，每个1表示在数组中的特定轴上移动</p><p>将其转换为索引的函数：</p><pre><code>def get_key(value):\n    key = value.split()\n    for character in key:\n        character = int(character)\n        print(type(character))\n\n    return key\n</code></pre><p>它应该将字符串转换为int，然后返回数组上的位置，但我得到的只是以下错误：</p><pre><code>TypeError: list indices must be integers or slices, not list\n</code></pre><p>有没有更好的方法，或者我做错了什么</p><p>编辑：</p><p>样本数据：</p><p>条件1=真\n条件2=错误</p><p>类别=[[6,8]，[21754]]</p><p>预期结果：21个，带键[1][0]</p></div>"}
{"href": "https://www.cnpython.com/qa/1478180", "title": "用于查找子字符串的正则表达式", "content": "<div class=\"show-content\"><p>我正在尝试使用正则表达式查找子字符串的所有出现。子字符串由三部分组成，以一个或多个“A”开头，后跟一个或多个“N”，以一个或多个“A”结尾。让一个字符串<em>'aaanabna'</em>，如果我解析这个字符串，我应该得到两个子字符串<em>'AAANAA'</em>和<em>'AANA'</em>，作为输出。因此，我尝试了下面的代码</p><pre><code>import regex as re\nreg_a='A+N+A+'\ns='AAANAANABNA'\nsub_str=re.findall(reg_a,s,overlapped=True)\nprint(sub_str)\n</code></pre><p>我得到了下面的输出</p><pre><code>['AAANAA', 'AANAA', 'ANAA', 'AANA', 'ANA']\n</code></pre><p>但是，我希望输出为</p><pre><code>['AAANAA', 'AANA']\n</code></pre><p>也就是说，第一场比赛的尾随A应该是下一场比赛的领先A。\n我怎么知道呢</p></div>"}
{"href": "https://www.cnpython.com/qa/1478178", "title": "如何在PYQT5中删除或删除Qlabel", "content": "<div class=\"show-content\"><p>代码如下：</p><pre><code>from generator import *\nfrom PyQt5 import QtWidgets\nfrom PyQt5.QtWidgets import QApplication, QMainWindow\nimport sys\n\nclass MyWindow(QMainWindow):\ndef __init__(self):\n    super(MyWindow,self).__init__()\n    self.initUI()\n\ndef button_clicked(self):\n    self.label.setText(make_pass())\n\ndef initUI(self):\n    self.setGeometry(200, 200, 300, 300)\n    self.setWindowTitle('Random password generator')\n\n    self.label = QtWidgets.QLabel(self)\n    self.label.setText('')\n    self.label.move(50,50)\n\n    self.b1 = QtWidgets.QPushButton(self)\n    self.b1.setText('Make password')\n    self.b1.clicked.connect(self.button_clicked)\n\ndef update(self):\n    self.label.adjustSize()\n\ndef window():\n    app = QApplication(sys.argv)\n    win = MyWindow()\n    win.show()\n    sys.exit(app.exec_())\n\nwindow()\n</code></pre><p>函数的作用是：返回一个字符串，一个名为password的变量</p><pre><code>def make_pass():\n    for i in range(6):\n        n = random.randint(0, 100)\n        if n % 2 == 0:\n            letters_list.append(random_letter(letters).lower())\n        elif n % 2 != 0:\n            letters_list.append(random_letter(letters).upper())\n\n    for i in range(3):\n        nums_list.append(random_number())\n\n    for i in range(2):\n        syms_list.append(random_symbol(syms))\n\n    l = ''.join(letters_list)\n    n = ''.join(nums_list)\n    s = ''.join(syms_list)\n\n    global password\n    password = l, n, s\n    password = ''.join(password)\n    pass_list = list(password)\n    random.shuffle(pass_list)\n    password = ''.join(pass_list)\n\n    return password\n</code></pre><p>当我运行它并按下generate按钮时，它会显示一个标签，即密码。当我再次运行它时，它将以前的密码与新密码结合在一起，并在单个标签中显示。\n我想要的是，当我生成一个密码和一个新密码后，前一个密码会被删除，并为新密码留出空间</p><p>问题是这样的：</p><p><img src=\"https://i.stack.imgur.com/rc0js.png\" alt=\"strings just add up\"></p><p>相反，它应该始终是一个由11个字符组成的字符串</p></div>"}
{"href": "https://www.cnpython.com/qa/1478181", "title": "如何在多索引数据帧的最外层使用iloc切片？", "content": "<div class=\"show-content\"><p>我有一个多索引数据帧，pd.timestamp作为顶级索引，一些任意参数作为第二级索引。您可以使用此代码段复制一些模拟数据：</p><pre><code>level0 = pd.period_range(start='2020-01-01-00:00:00', end='2020-01-01-00:01:00', freq='s')\nlevel1 = ['foo', 'bar', 'foobar']\nvalues = np.random.rand(len(level1)*len(level0))\nidx = pd.MultiIndex.from_product([level0, level1], names=['time', 'level1'])\ncol = ['value']\ndf = pd.DataFrame(values, idx, col)\nprint(df)\n</code></pre><p>这将创建输出：</p><pre><code>                               value\ntime                level1          \n2020-01-01 00:00:00 foo     0.345507\n                    bar     0.147654\n                    foobar  0.617000\n2020-01-01 00:00:01 foo     0.430975\n                    bar     0.783075\n...                              ...\n2020-01-01 00:00:59 bar     0.027083\n                    foobar  0.553220\n2020-01-01 00:01:00 foo     0.253957\n                    bar     0.569881\n                    foobar  0.976768\n</code></pre><p>现在我想把每一秒作为进一步计算的数据。我的第一种方法是使用<code>.iloc[::n]</code>，如果先解除数据帧的堆栈，这种方法可以很好地工作。因此代码<code>df.unstack().iloc[::5].stack()</code>正好生成我想要的输出：</p><pre><code>                               value\ntime                level1          \n2020-01-01 00:00:00 bar     0.147654\n                    foo     0.345507\n                    foobar  0.617000\n2020-01-01 00:00:05 bar     0.083129\n                    foo     0.591585\n                    foobar  0.660372\n2020-01-01 00:00:10 bar     0.460798\n                    foo     0.308138\n                    foobar  0.622412\n...                              ...\n2020-01-01 00:00:55 bar     0.700964\n                    foo     0.556782\n                    foobar  0.601582\n2020-01-01 00:01:00 bar     0.569881\n                    foo     0.253957\n                    foobar  0.976768\n</code></pre><p>然而，当df变大时，拆垛和堆叠变得非常密集。我觉得有一个简单、优雅且“便宜”的解决方案，我就是抓不住</p><p>是否有一种解决方案可以选择每一个<em>n</em>-th时间戳，以避免取消数据堆叠</p><p>编辑：对于任何阅读本文的人来说：虽然jezraels的回答是一个很好的方法，并告诉我如何处理这个问题，但对于我的案例（每月的第二次数据和ca 300个“level1”-条目），结果证明<code>unstack().iloc[::n].stack()</code>方法更快，扩展性更好</p></div>"}
{"href": "https://www.cnpython.com/qa/1478182", "title": "Google云平台运行时公共FTL AttributeError'NoneType'对象没有属性'rsplit'", "content": "<div class=\"show-content\"><p>你能帮我解决这个问题吗。我试图通过ftl生成dockerfile，但得到一个错误</p><p>我的系统：</p><pre><code>python3 --version =&gt; Python 3.7.3\nnode -v =&gt; v12.18.0\nnpm -v =&gt; 6.14.4\nsystem_profiler SPSoftwareDataType =&gt;\nSoftware:\nSystem Software Overview:\nSystem Version: macOS 10.15.5 (19F101)\nKernel Version: Darwin 19.5.0\nBoot Volume: Macintosh HD\nBoot Mode: Normal\nSecure Virtual Memory: Enabled\nSystem Integrity Protection: Enabled\n</code></pre><p>我遵循以下步骤：</p><pre><code>1- mkdir examples\n2- cd examples\n3- npm init -y\n4- echo 'console.log(\"hello world\");' &gt;&gt; file.js\n5- echo 'FROM node:12.18.0-alpine' &gt;&gt; dockerfile\n6- echo 'WORKDIR /app' &gt;&gt; dockerfile\n7- echo 'cp file.js ./' &gt;&gt; dockerfile\n8- echo 'CMD [\"node\",\"file.js\"]' &gt;&gt; dockerfile\n9- python ./ftl.par --directory=$(pwd) --name=image --tar_base_image_path=$(pwd)\n</code></pre>\n注：FL.Par从^ {A1}<p>我收到一个错误：</p><pre><code>INFO FTL version node-v0.18.0\nINFO Beginning FTL build for node\nINFO FTL arg passed: exposed_ports None\nINFO FTL arg passed: cache_repository None\nINFO FTL arg passed: tar_base_image_path /Users/smhmayboudi/Developer/kaniko/examples\nINFO FTL arg passed: export_cache_stats False\nINFO FTL arg passed: builder_output_path None\nINFO FTL arg passed: name image\nINFO FTL arg passed: ttl 168\nINFO FTL arg passed: global_cache False\nINFO FTL arg passed: cache True\nINFO FTL arg passed: upload True\nINFO FTL arg passed: sh_c_prefix False\nINFO FTL arg passed: fail_on_error True\nINFO FTL arg passed: base None\nINFO FTL arg passed: output_path None\nINFO FTL arg passed: cache_key_version v0.18.0\nINFO FTL arg passed: cache_salt\nINFO FTL arg passed: directory /Users/smhmayboudi/Developer/kaniko/examples\nINFO FTL arg passed: entrypoint None\nINFO FTL arg passed: additional_directory None\nINFO FTL arg passed: destination_path srv\nINFO FTL arg passed: verbosity NOTSET\nINFO starting: full build\nINFO starting: builder initialization\nINFO builder initialization took 0 seconds\nINFO full build took 0 seconds\nTraceback (most recent call last):\nFile \"/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/runpy.py\", line 174, in _run_module_as_main\n\"main\", fname, loader, pkg_name)\nFile \"/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/runpy.py\", line 72, in run_code\nexec code in run_globals\nFile \"./ftl.par/main.py\", line 65, in\nFile \"./ftl.par/main.py\", line 52, in main\nFile \"./ftl.par/main/ftl/node/builder.py\", line 31, in init\nFile \"./ftl.par/main/ftl/common/builder.py\", line 89, in init\nFile \"./ftl.par/containerregistry/client/docker_name.py\", line 182, in init\nAttributeError: 'NoneType' object has no attribute 'rsplit'\n</code></pre></div>"}
{"href": "https://www.cnpython.com/qa/1478184", "title": "Python正则表达式捕获两个匹配之间的文本？", "content": "<div class=\"show-content\"><p>我想使用一个正则表达式来匹配两个字符串之间的任何文本：</p><pre><code>DATE POSTED: MAY 30, 2018, some text here, Garcia Answer 1: more text, DATE POSTED: MARCH 8, 2017, some text here, Smith Answer 2: more text, DATE POSTED: JUNE 17, 2018, some text here, Jones Answer 1: more text...\n</code></pre><p>在这个例子中，我想搜索<code>DATE POSTED: [*date*],</code>和<code>, [*Name*] Answer [*number*]:</code>并获取两者之间的所有内容</p><p>换句话说，我想找到所有<code>some text here</code></p><p>我使用的是python3x</p></div>"}
{"href": "https://www.cnpython.com/qa/1478185", "title": "Python/我不理解列表中循环的一行", "content": "<div class=\"show-content\"><p>下面的代码是特定字符串在给定字符串中连续出现的次数。但我无法理解<code>[sum(1 for _ in group)+1 for label, group in groups if label==''][0]</code>的逻辑。我在找一个解释。我正在写我所理解的，以便你能纠正我。非常感谢您的帮助和解释，谢谢您的时间</p><p>从<code>sum(1 for _ in group)+1</code>：对<code>group</code>中的任何东西求和1，但我认为<code>group</code>没有定义，我不知道它是否是库中附带的东西，但它没有颜色</p><p>从<code>[sum(1 for _ in group)+1 for label, group in groups if label==''][0]</code>开始，如果label是一个空字符串，但我不知道结尾处的<code>[0]</code>，我基本上无法理解</p><pre><code>from itertools import groupby\ncheckstr = ['AGATC', 'AATG', 'TATC']\ns = 'GCTAAATTTGTTCAGCCAGATGTAGGCTTACAAATCAAGCTGTCCGCTCGGCACGGCCTACACACGTCGTGTAACTACAACAGCTAGTTAATCTGGATATCACCATGACCGAATCATAGATTTCGCCTTAAGGAGCTTTACCATGGCTTGGGATCCAATACTAAGGGCTCGACCTAGGCGAATGAGTTTCAGGTTGGCAATCAGCAACGCTCGCCATCCGGACGACGGCTTACAGTTAGTAGCATAGTACGCGATTTTCGGGAAATGAATGAATGAATGAATGAATGAATGAATGAATGAATGAATGAATGAATGAATGAATGAATGAATGAATGAATGAATGAATGAATGAATGAATGAATGAATGAATGAATGAATGAATGAATGAATGAATGAATGAATGAATGAATGAATGAATGAATGAATGAATGAATGTATCTATCTATCTATCTATCT'\nfor c in checkstr:\n    groups = groupby(s.split(c))\n    try:\n        print(c,[sum(1 for _ in group)+1 for label, group in groups if label==''][0])\n    except IndexError:\n        print(c,0)\n    print(sum(1 for _ in group)+1)\n</code></pre></div>"}
{"href": "https://www.cnpython.com/qa/1478186", "title": "ValueError:长度不匹配：预期轴有0个元素，新值有7个元素", "content": "<div class=\"show-content\"><pre><code>def getNearbyVenues(names, latitudes, longitudes, radius=500):\n\n    venues_list=[]\n    for name, lat, lng in zip(names, latitudes, longitudes):\n        print(name)\n\n        url = 'https://api.foursquare.com/v2/venues/explore?&amp;client_id={}&amp;client_secret={}&amp;v={}&amp;ll={},{}&amp;radius={}&amp;limit={}'.format(\n            CLIENT_ID, CLIENT_SECRET, VERSION, lat, lng, radius, LIMIT)\n\n        results = requests.get(url).json()[\"response\"]['groups'][0]['items']\n\n        venues_list.append([( name, lat, lng, v['venue']['name'], v['venue']['location']['lat'], v['venue']['location']['lng'], v['venue']['categories'][0]['name']) for v in results])\n\n\n    nearby_venues = pd.DataFrame([item for venue_list in venues_list for item in venue_list])\n    nearby_venues.columns = ['Neighborhood', 'Neighborhood Latitude', 'Neighborhood Longitude', 'Venue', 'Venue Latitude', 'Venue Longitude', 'Venue Category']\n\n\n    return(nearby_venues)\n</code></pre><p>当我调用上面的函数时</p><pre><code>toronto_venues = getNearbyVenues(names=df['Neighborhood'], latitudes=df['Latitude'],longitudes=df['Longitude'])\n</code></pre><p>我犯了以下错误</p><pre><code>---------------------------------------------------------------------------\nValueError                                Traceback (most recent call last)\n&lt;ipython-input-43-0a244f551e86&gt; in &lt;module&gt;\n      2 #nearyby_venues\n      3 #toronto_venues = pd.DataFrame(pd.np.empty((0, 7)))\n----&gt; 4 toronto_venues = getNearbyVenues(names=df['Neighborhood'], latitudes=df['Latitude'],longitudes=df['Longitude'])\n\n&lt;ipython-input-42-217083dbcb80&gt; in getNearbyVenues(names, latitudes, longitudes, radius)\n     14 \n     15     nearby_venues = pd.DataFrame([item for venue_list in venues_list for item in venue_list])\n---&gt; 16     nearby_venues.columns = ['Neighborhood', 'Neighborhood Latitude', 'Neighborhood Longitude', 'Venue', 'Venue Latitude', 'Venue Longitude', 'Venue Category']\n     17 \n     18 \n\n~\\Anaconda3\\lib\\site-packages\\pandas\\core\\generic.py in __setattr__(self, name, value)\n   5285         try:\n   5286             object.__getattribute__(self, name)\n-&gt; 5287             return object.__setattr__(self, name, value)\n   5288         except AttributeError:\n   5289             pass\n\npandas\\_libs\\properties.pyx in pandas._libs.properties.AxisProperty.__set__()\n\n~\\Anaconda3\\lib\\site-packages\\pandas\\core\\generic.py in _set_axis(self, axis, labels)\n    659 \n    660     def _set_axis(self, axis, labels) -&gt; None:\n--&gt; 661         self._data.set_axis(axis, labels)\n    662         self._clear_item_cache()\n    663 \n\n~\\Anaconda3\\lib\\site-packages\\pandas\\core\\internals\\managers.py in set_axis(self, axis, new_labels)\n    176         if new_len != old_len:\n    177             raise ValueError(\n--&gt; 178                 f\"Length mismatch: Expected axis has {old_len} elements, new \"\n    179                 f\"values have {new_len} elements\"\n    180             )\n\nValueError: Length mismatch: Expected axis has 0 elements, new values have 7 elements\n</code></pre><p>从堆栈跟踪中我了解到，问题是由<code>nearby_venues</code>数据帧引起的，我分配列的方式是错误背后的主要原因。我能做些什么来解决这个问题</p></div>"}
{"href": "https://www.cnpython.com/qa/1478192", "title": "如何在python中显示数据库中编码的base64字符串中解码的base64 pdf文件？", "content": "<div class=\"show-content\"><p>字节=B64如果字节[0:4]！=b“%PDF”：raise VALUERROR（'缺少PDF文件签名'）f=open（'file.PDF'，wb'）f.write（字节）f.close（）要显示“file.PDF”</p><p>f=open（'file.pdf'，'rb'）dat=f.read（）返回dat#获取字节格式错误的pdf文件</p></div>"}
{"href": "https://www.cnpython.com/qa/1478194", "title": "Python单元测试，日期时间", "content": "<div class=\"show-content\"><p>我的问题是：\n在我接下来的测试中，今天一切都正常，但明天就不行了，我是一个初学者，尝试了很多选择，但我失败了，我尝试通过“now”作为参数，但直到现在都没有成功。\n我必须停止“datetime.now（）”并设置一个固定日期来测试所有变量。\n在这之前我一直在进步，但我被困在这上面了\n你能帮帮我吗？\n非常感谢。\n弗拉维奥</p><pre class=\"lang-py prettyprint-override\"><code>\nimport unittest\nfrom datetime import datetime\n\n\ndef get_last_name_and_birthday(name, d):\n    x = name.split()\n    dob = d.split(\"-\")\n    year, month, day = int(dob[2]), int(dob[1]), int(dob[0])\n    user_birthday = datetime(year, month, day)\n    return x[-1], user_birthday\n\n\ndef calc_days(user_birthday):\n    now = datetime.now()\n    if user_birthday &lt; now:\n        birthday = datetime(now.year + 1, user_birthday.month, user_birthday.day)\n        return (birthday - now).days + 1\n    else:\n        birthday = datetime(now.year, user_birthday.month, user_birthday.day)\n        return (birthday - now).days + 1\n\n\ndef generate_output(last_name, cd):\n    if cd == 365:\n        return \"Hello Mr \" + last_name + \" Happy Birthday\"\n    elif cd &lt; 365:\n        return \"Hello Mr \" + last_name + \" your birthday is in \" + str(cd) + \" days\"\n    else:\n        return \"Hello Mr \" + last_name + \" your birthday is in \" + str(cd - 365) + \" days\"\n\n\ndef process_name_and_birthday(name, dob):\n    last_name, user_birthday = get_last_name_and_birthday(name, dob)\n    cd = calc_days(user_birthday)\n    return generate_output(last_name, cd)\n\n\n#name = input(\"type your full name: \")\n#dob = input(\"type your date of birthday(dd-mm-yy): \")\n#print(process_name_and_birthday(name, dob))\n\n\n\nclass BirthdayTest(unittest.TestCase):\n    def test_same_day_birthday(self):\n        self.assertEqual(\"Hello Mr Oliveira Happy Birthday\", process_name_and_birthday(\"Flavio Oliveira\", \"11-06-1990\"))\n\n\nclass DaysToBirthdayTest(unittest.TestCase):\n    def test_days_to_birthday(self):\n        self.assertEqual(\"Hello Mr Oliveira your birthday is in 9 days\", process_name_and_birthday(\"Flavio Oliveira\", \"20-06-1978\"))\n\n\nclass DaysToPassedBirthdayTest(unittest.TestCase):\n    def test_how_many_days_passed_birthday(self):\n        self.assertEqual(\"Hello Mr Oliveira your birthday is in 364 days\", process_name_and_birthday(\"Flavio Oliveira\", \"10-06-1978\"))\n\n\nunittest.main()\n\n\n\n</code></pre></div>"}
{"href": "https://www.cnpython.com/qa/1478193", "title": "用于在管道删除文件中将模式“abc”替换为“*”的Python代码", "content": "<div class=\"show-content\"><p>我是Python新手，我有一个管道分隔的文件，我想用“*”替换单引号中的字符，它们出现在最后一列/4列中</p><pre><code>abc|123|xyz|456|select * from table emp where custname='John'    \nxyz|123|'John'|789|select * from table emp   \n'John'|456|abc|123|select abc from table emp\n</code></pre><p>在上面的示例中，您可以在单引号中看到“John”。我想用“*”来掩饰“约翰”。在第二行和第三行中，您可以在单引号中看到“John”，我不想屏蔽它，因为它们不在最后一列中</p><p>我的要求是屏蔽最后一列中单引号中的数据</p><p>预期产出：</p><pre><code>abc|123|xyz|456|select * from table emp where custname='*'  \nxyz|123|'John'|789|select * from table emp  \n'John'|456|abc|123|select abc from table emp\n</code></pre></div>"}
{"href": "https://www.cnpython.com/qa/1478183", "title": "使用BS4进行Web抓取时，按div id选择仍然会返回整个页面", "content": "<div class=\"show-content\"><p>我正试图从维基百科的时事页面中找到：<a href=\"https://en.wikipedia.org/wiki/Portal:Current_events\" rel=\"nofollow noreferrer\">https://en.wikipedia.org/wiki/Portal:Current_events</a>。特别是当前日期。使用inspect元素，我可以看到我想要的所有信息都存储在id为“2020年6月15日”的a div中。在我的脚本中，我指定了特定的id，但是我当前的脚本继续从页面中提取所有内容。我错过了什么</p><p>以下是python脚本wiki.py：</p><pre><code>import sys\nimport requests\nimport bs4\n\nres = requests.get('https://en.wikipedia.org/wiki/Portal:Current_events')\nres.raise_for_status()\n\n\nsoup = bs4.BeautifulSoup(res.text,\"lxml\")\nelems = soup.select('div', {\"id\": \"2020_June_15\"})\nfor i in range(len(elems)):\n    print(elems[i].getText())\n</code></pre></div>"}
{"href": "https://www.cnpython.com/qa/1478195", "title": "找到给出最大和的一对，使第二个元素位于第一个元素之后", "content": "<div class=\"show-content\"><p>假设我有两个长度相等的<code>numpy</code>数组：</p><pre class=\"lang-py prettyprint-override\"><code>a = np.array([1, 3, 5, 3, 2, 0])\nb = np.array([1, 1, 2, 2, 4, 3])\n</code></pre><p>在所有的<code>i, j</code>这样的<code>j &gt;= i</code>中，我如何才能找到<code>i</code>和<code>j</code>这样的</p><pre class=\"lang-py prettyprint-override\"><code>a[i] + b[j]\n</code></pre><p>是否最大化</p><p>考虑到我的实际用例，不太可能出现平局，但是如果有平局，返回最小的<code>i</code>和<code>j</code>就可以了</p></div>"}
{"href": "https://www.cnpython.com/qa/1478202", "title": "无法将SQL数据读入ReportLab行", "content": "<div class=\"show-content\"><p>我正在从事一个reportlab项目，其中数据是从SQlite3表读取的。它无法读取并将其转换为系统读取和发布的正确格式。最初，我从一个csv文件中调用数据，该文件工作正常。值得一提的是，我以正确的格式展示了这一点</p><pre><code>str_rankings = (self.choose_class_combo.currentText() + ' ' + self.choose_term_combo.currentText() + ' ' + self.choose_year_combo.currentText() + ' ' + \" STREAM RANKINGS.pdf\")\npdf2=SimpleDocTemplate(str_rankings)\nframe1 = Frame(30,20,900,600)\nland = PageTemplate(id='l',pagesize=[950,650],frames=[frame1])\nheading = self.choose_class_combo.currentText()+' '+self.choose_term_combo.currentText()+' '+self.choose_year_combo.currentText()+' OVERALL PERFOMANCE AND GRADE BREAKDOWN'\ndescrip = ParagraphStyle('description',fontName='Courier-Bold',fontSize=18,leading=30, alignment=TA_CENTER)\nhead_text = Paragraph(heading,descrip)\npdf.addPageTemplates([land])\npdf2.addPageTemplates(PageTemplate(id='l',pagesize=[950,650],frames=[frame1]))\nflow_obj=[]\nflow_obj.append(head_text)\n#creating the connection\nconn = sqlite3.connect('mydb.db')\ncur = conn.cursor()\nstr_summary = pd.read_sql(\"select * from '\" + str(overall_summary) + \"'\", conn)\nwith open(str_summary) as f1:\n    csvdata=csv.reader(f1,delimiter=\",\")\n    tdata=[]\n    for data in csvdata:\n        rowdata=[]\n        BLANK=data[0]\n        A1 =data[1]\n        A2=data[2]\n        B3=data[3]\n        B4=data[4]\n        B5=data[5]\n        C6=data[6]\n        C7=data[7]\n</code></pre><p>它抛出了这个错误</p><pre><code>Traceback (most recent call last):\n  File \"D:\\Python\\PyQt5\\Backup\\Result Management System(RMS)\\REMARE 2.py\", line 2084, in get_results\n    with open(str_summary) as f1:\nTypeError: expected str, bytes or os.PathLike object, not DataFrame\n</code></pre></div>"}
{"href": "https://www.cnpython.com/qa/1478196", "title": "在Python中似乎无法交换记录数组中的行", "content": "<div class=\"show-content\"><p>似乎无法交换表中的两行。如您所见，位置1成功复制到位置0，但不是相反？每个位置的数据都是在交换之前存储的，因此计算机不会将新覆盖的数据放入新位置</p><p>代码：</p><pre><code>```\nimport numpy as np\n\nname = ['Alice1', 'Bob', 'Cathy', 'Doug']\nage = [25, 45, 100, 19]\nweight = [55.0, 85.5, 68.0, 61.5]\n\ndata = np.zeros(4, dtype={'names': ('name', 'age', 'weight'), 'formats': ('U10', 'i4', 'f8')})\n\ndata['name'] = name\ndata['age'] = age\ndata['weight'] = weight\n\npos0 = data[0]\npos1 = data[1]\n\ndata[0] = pos1\ndata[1] = pos0\n\nprint(data)\n```\n</code></pre><p>输出：</p><pre><code>```\nORIGIONAL LIST: [('Alice1',  25, 55. ) ('Bob',  45, 85.5) ('Cathy', 100, 68. )\n('Doug',  19, 61.5)]\nNEW SWAPPED LIST: [('Bob',  45, 85.5) ('Bob',  45, 85.5) ('Cathy', 100, 68. )\n('Doug',  19, 61.5)]\n```\n</code></pre></div>"}
{"href": "https://www.cnpython.com/qa/1478197", "title": "循环中生成的多个（matplotlib）绘图未明显更新", "content": "<div class=\"show-content\"><p>因此，我试图在一个循环中生成两个单独的图形，这样在每次迭代中，绘图都会用函数的最新输出刷新：</p><pre><code>import numpy as np\nfrom matplotlib import pyplot as plt\n\nfigA, axA = plt.subplots()\nfigB, axB = plt.subplots()\n\nfor n in range(10):\n    dataA = np.random.randint(0, 10, 10)\n    dataB = np.random.randint(0, 10, 10)\n\n    axA.clear()\n    axB.clear()\n\n    axA.plot(dataA)\n    axB.plot(dataB)\n\n    plt.show()\n    plt.pause(1)\n</code></pre><p>然而，现在发生的事情是，只有figB被明显更新，而figA没有。循环完成后，两个图都显示最终输出</p><p>为什么两个数字在每个循环上都没有明显的更新</p><p>（编辑：可运行代码，添加plt.show（），但这并不能解决问题）</p></div>"}
{"href": "https://www.cnpython.com/qa/1478198", "title": "合并两个“for”循环ValueError:没有足够的值来解包（预期为3，得到1）", "content": "<div class=\"show-content\"><p>对于当前的项目，我计划将下面的两个For循环结合起来，以便将输入保存在一个数据表中</p><p>到目前为止，我试图将循环（例如与<code>for word, freq, element in ([common_words],[polarity_list]):</code>）合并，结果显示了以下消息<code>ValueError: not enough values to unpack (expected 3, got 1)</code></p><p>是否有任何聪明的调整，使这个运行？相应代码如下：</p><pre><code>for i in ['Text_Pro','Text_Con','Text_Main']:\n    common_words = str(get_top_n_trigram(df[i], 150))\n    polarity_list = str([TextBlob(i).sentiment.polarity for i in common_words])\n    for element in polarity_list:\n        print(i, element)\n    for word, freq in common_words:\n        print(i, word, freq)\n</code></pre></div>"}
{"href": "https://www.cnpython.com/qa/1478199", "title": "如何更改散点图的颜色", "content": "<div class=\"show-content\"><p>数据集如下所示</p><pre><code>sino,cost,profit,product\n1,567510,359807,600\n2,256203,154802,459\n3,523447,664310,655\n4,201928,449702,778\n5,270359,913417,659\n</code></pre><p>代码如下</p><pre><code>import pandas as pd\nimport seaborn as sn\ndf = pd.read_csv('1.csv')\ndf1 = df[['cost','profit','product']]\nsns.pairplot(df1)\n</code></pre><ul><li><p>我的图表如下</p></li><li><p>图中的分析是什么</p></li><li>如何改变颜色，首先成本是红色，利润是蓝色，产品是绿色</li></ul><p><a href=\"https://i.stack.imgur.com/5eRiA.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/5eRiA.png\" alt=\"enter image description here\"></a></p></div>"}
{"href": "https://www.cnpython.com/qa/1478200", "title": "如何避免tensorflow中的循环中出现过多的操作？", "content": "<div class=\"show-content\"><p>***<strong>版本</strong>：为了避免含糊不清，我的问题是“太多”操作，“太多”操作。不是关于某个op的数值</p><blockquote><p>My Old Title: How to avoid a large number of ops from a loop in\ntensorflow?</p></blockquote><p>**以下是主要案文</p><p>嗨，伙计们。我正在使用tensorflow 1.12实现一个网络</p><h2>背景是：</h2><p>在我的损失函数中，我想计算从每个输入图像中采样的大量（大约5000个）随机点对，这会花费我大量的内存和时间。点对的下标是通过某种随机方法选择的，因此我认为不可能将循环集成到矩阵中。它看起来是这样的：（在<code>my_loss_func()</code>）</p><pre><code># gt &amp; pred is tensors of [w, h]\n# x1, y1, x2, y2 are lists of the point pairs' coordinates which were randomly sampled from input image\n# for example, x1 = [1, 2, 3], y1 = [4, 5, 6], x2 = [7, 8, 9], y2 = [10, 11, 12]\n# then it will compute loss between gt[1, 4] &amp; pred[7, 10], gt[2, 5] &amp; pred[8, 11] etc.\n\nnum_pairs = 5000\n...\n\n# compute loss for this batch\nfor i in range(num_pairs):\n   diff = gt[x1[i], y1[i]] - pred[x2[i], y2[i]]\n   loss = some_math_computation(diff)\n\nreturn loss/num_pairs\n\n</code></pre><h2>问题是：</h2><p>如果我像上面那样构建这个图，它肯定会创建5k次的损失计算op，这花费了我很多。事实上，每次我运行程序时，我都必须等待大约10分钟，才能训练第一批数据。在我的调试日志中，我发现循环在一秒钟内只运行了大约25次。因此，巨大的时间成本肯定是从这里开始的。我觉得自己不舒服</p><p>你能告诉我如何避免像这样构建图表吗？顺便说一句，我正在使用<code>tf.estimator</code>，因此<code>sess.run()</code>操作无效</p><h2>我的意见是：</h2><p>也许我可以加载一次总图，并将此图另存为文件。然后，每次运行模型时，我都可以从该文件加载整个图形，因此我不需要等待这么长时间。行吗</p><p>请告诉我实施这种损失的正确方法。我想这种损失在计算机视觉的某些领域是很常见的</p></div>"}
{"href": "https://www.cnpython.com/qa/1478201", "title": "如何使用正则表达式制作假人？", "content": "<div class=\"show-content\"><p>例如，我有一个reviews列，我想提取单词并基于它们创建虚拟变量</p><p>我在这里使用它，但不能使用正则表达式：</p><pre><code>df = df['reviews'].str.contains('good').astype(int)\n</code></pre><p>如何在这里使用正则表达式来提取good、goid、goof等</p></div>"}
{"href": "https://www.cnpython.com/qa/1478203", "title": "当部分字符串匹配时，如何基于字典替换整个数据帧中的值？", "content": "<div class=\"show-content\"><p>嗨，我有2个数据帧，其中我必须使用1个数据帧替换其他数据帧中的值。我通常可以创建字典来替换整个数据帧中的值，但其他数据帧中的值有点不同，所以我需要一个条件，在这个条件下，我可以判断字符串的部分是否匹配，然后它应该映射字典。\n第一个数据帧如下所示：</p><p><a href=\"https://i.stack.imgur.com/zhJBO.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/zhJBO.png\" alt=\"enter image description here\"></a></p><p>第二个数据帧如下所示：</p><pre><code>        id        cars1                     cars2\n\n        1     $ {hQOpelText.r1.val}        BMW\n        2     $ {hQOpelText.r2.val}        $ {hQOpelText.r2.val}\n        3     $ {hQOpelText.r3.val}        $ {hQOpelText.r5.val}\n        4     $ {hQOpelText.r4.val}        Audi\n        5     $ {hQOpelText.r5.val}        Audi\n</code></pre><p>我想这样做：</p><pre><code>        id        cars1                     cars2\n\n        1     Opel Adam                   BMW\n        2     Opel Astra Estate           Opel Astra Estate\n        3     Opel Astra Hatchback        Opel Grandland x \n        4     Opel Astra Saloon           Audi\n        5     Opel Grandland x            Audi\n</code></pre></div>"}
{"href": "https://www.cnpython.com/qa/1478204", "title": "检查我的数组是否遵循特定格式", "content": "<div class=\"show-content\"><p>我试图在python中找到一种方法，使用循环检查我的数组是否遵循该格式</p><pre><code>[string,number,symbol,string,number,symbol.......]\n</code></pre><p>最简单的方法是什么</p></div>"}
{"href": "https://www.cnpython.com/qa/1478205", "title": "在#Python中，如何通过按enter键自动添加数字", "content": "<div class=\"show-content\"><p>我正在尝试编写一个小的#Pythonn代码，其中只要用户输入键，空列表就会通过随机整数不断追加</p><p>我正在考虑使用while循环，例如while intnum==0=&amp;gt；intnum+=random.append（）</p><p>在我看来，我可以让它工作，但不能得到正确的语法：（</p><p>请帮忙。\nPython新手</p></div>"}
{"href": "https://www.cnpython.com/qa/1478206", "title": "使用python和SQL插入整个列表", "content": "<div class=\"show-content\"><p>我正在使用INSERT INTO在数据库中插入数据</p><p>主要问题是我插入了大约170k个数据点，我循环了这样一个代码：</p><pre><code>for row in data:\n   SQL='''INSERT INTO Table\n       VALUES ({},{},{})\n   '''.format(row[0],row[1],row[2])\n   cur.execute(SQL)\ncur.commit()\ncur.close()\ncon.close()\n</code></pre><p>这个代码非常慢，有没有更快的方法呢</p><p>我在想是否有一种方法可以同时插入整个矩阵数据列</p></div>"}
{"href": "https://www.cnpython.com/qa/1478207", "title": "如何使用条件从字典中提取值", "content": "<div class=\"show-content\"><p>我的字典如下，如果值以<code>csv</code>或<code>json</code>结尾，我需要放入同一字典的另一个字典中：</p><pre><code>d = {'a': ['1.json', '1.html', '1.csv'], 'B': ['2.json', '2.html', '2.csv']}\n</code></pre><p>代码如下：</p><pre><code>d = {}\nfor k,v in d.items():\n    for i in v:\n        if i.split('.')[1] == 'csv' or i.split('.')[1] == 'json':\n            d[k] = v\n</code></pre><p>我的</p><pre><code>{'a': ['1.json', '1.html', '1.csv'], 'B': ['2.json', '2.html', '2.csv']}\n</code></pre><p>预料之外</p><pre><code>{'a': ['1.json', '1.csv'], 'B': ['2.json', '2.csv']}\n</code></pre></div>"}
